\chapter{Hamiltonian Approach to Generalized Harmonic Formulation}\label{hamiltonian}
Einstein-Hilbert action encodes complete dynamic information of general relativity system. Applying variational principle to the action yields Einstein field equations. Both Lagrangian and Hamiltonian equations can be derived from the principle of least action. In this chapter, we write down the Einstein-Hilbert action of generalized harmonic formulation in Sec.~\ref{action}. Hamiltonian and equations of motion for GH system are spelled out in Sec.~\ref{hamiltonian}. An extension of the Hamiltonian for the purpose of general covariance is discussed in Sec.~\ref{extension}. In the end, a well-posedness analysis of the system is presented in Sec.~\ref{wellposedness}. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Action of Generalized Harmonic Formulation}\label{action}
As presented in Ref.~\cite{Brown:2010rya}, the Lagrangian for generalized harmonic gravity is the following function of the spacetime metric $g_{\mu\nu}$ and the gauge source vector $H_{\mu}$, 
\begin{equation}
\mathscr{L}\left(g_{\mu\nu}, H^{\mu}\right) = \sqrt{-^{(4)}g} \left(^{(4)}R - \frac{1}{2}C_{\mu}C^{\mu}\right) \ , 
\end{equation}
and the action is a functional of $g_{\mu\nu}$ and $H^{\mu}$
\begin{equation}\label{action}
S\left[g_{\mu\nu}, H^{\mu}\right] = \int \mathscr{L} d^{4}x \ .
\end{equation}
In the Lagrangian, $^{(4)}g$ is determinant of the spacetime metric, $^{(4)}R$ stands for spacetime Ricci scalar and $C_{\mu}$ is the generalized harmonic constrains defined as
\begin{equation}
C_{\mu} = H_{\mu} + \Delta \Gamma^{~~~\beta}_{\mu\beta}
\end{equation}
where $H_{\mu}$ is the gauge source vector. 

Employing 3 + 1 decomposition to split the spacetime metric $g_{\mu\nu}$ into spatial metric $g_{ab}$, lapse function $\alpha$ and shift vector $\beta^{a}$, the gauge source vector $H_{\mu}$ into its time-like component $H_{\perp}$ and spatial component $H_{a}$, the action turns into the following 3 + 1 form
\begin{equation}\label{3+1action}
S\left[g_{ab}, \alpha, \beta^{a}, H_{\perp}, H^{a}\right] = \int d^{4}x~~\alpha \sqrt{g} \left( R + K^{ab}K_{ab} - K^{2} - \frac{1}{2}C^{a}C_{a} + \frac{1}{2}C_{\perp}^{2}\right).
\end{equation}
In Eq.~(\ref{3+1action}), $R$ is the spatial Ricci scalar, $K$ is the trace of extrinsic curvature and $\mathcal{L}_{\beta}$ is the Lie derivative along the shift vector. 

The splitting of $C_{\mu}$ is more delicate. According to the 3 + 1 splitting discussed in Appendix A of Ref.~\cite{Brown:2011qg}, we split $C_{\mu}$ into $C_{\perp}$ and $C_{a}$, where
\begin{equation}
C_{\perp} = {\tilde H}_{\perp} + K + \frac{1}{\alpha^{2}}D_{t}\alpha
\end{equation}
and
\begin{equation}
C_{a} = {\tilde H}_{a} + \Delta \Gamma^{b}_{cd}g^{cd}g_{ab} - \frac{\partial_{a}\alpha}{\alpha} - \frac{g_{ab}}{\alpha^2}D_{t}\beta^{b} \ .
\end{equation}
Here, ${\tilde H}_{\perp}$ and ${\tilde H}_{a}$ are the modified gauge source vector components, where
\begin{subequations}
\begin{align}
{\tilde H}_{\perp} & \equiv H_{\perp} - \frac{\alpha}{{\bar \alpha}}{\bar K}_{ab}g^{ab} + \frac{{\bar K}_{ab}}{\alpha{\bar \alpha}}\Delta \beta^{a} \Delta \beta^{b} + \frac{2}{\alpha {\bar \alpha}}\Delta \beta^{a} \partial_{a}{\bar \alpha}, \\
{\tilde H}_{a} & \equiv H_{a} + \frac{{\bar \alpha}}{\alpha^2}g_{ab}{\bar g}^{bc}\partial_{c}{\bar \alpha} + \frac{g_{ab}\Delta \beta^{b}}{\alpha^2 {\bar \alpha}}(\alpha^2g^{cd}{\bar K}_{cd} - 2\Delta\beta^{c}\partial_{c}{\bar \alpha}) - \frac{g_{ab}{\bar K}_{cd}\Delta \beta^{c}}{\alpha^2{\bar \alpha}}(\Delta \beta^{b}\Delta \beta^{d} - 2{\bar \alpha}^2{\bar g}^{bd}) \ .
\end{align}
\end{subequations}
Since absorbing terms that depend on physical fields $g_{ab}$, $\alpha$, $\beta^{a}$, background fields ${\bar g}_{ab}$, ${\bar \alpha}$, ${\bar \beta}^{a}$ and derivatives of the background fields into $H_{\perp}$ and $H_{a}$ won't change the hyperbolicity of GH formulation\cite{Brown:2011qg}, later in the paper, we refer ${\tilde H}_{\perp}$ and ${\tilde H}_{a}$ as $H_{\perp}$ and $H_{a}$, respectively. Therefore, we rewrite the splitting of $C_{\perp}$ and $C_{a}$ as following
\begin{subequations}
\begin{align}
C_{\perp} & = H_{\perp} + K + \frac{1}{\alpha^{2}}D_{t}\alpha\\
C_{a} & = H_{a} + \Delta \Gamma^{b}_{cd}g^{cd}g_{ab} - \frac{\partial_{a}\alpha}{\alpha} - \frac{g_{ab}}{\alpha^2}D_{t}\beta^{b} \ .
\end{align}
\end{subequations}
With the action defined explicitly, we are now able to construct the Hamiltonian formalism of GH formulation in the following sections. 
%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%
\section{Hamiltonian and Equations of Motion}\label{hamiltonian}
According to Eq.~(\ref{3+1action}), we have that the Lagrangian in 3 + 1 form is
\begin{equation}
\mathscr{L}\left(g_{ab}, \alpha, \beta^{a}, H_{\perp}, H^{a}\right) = \alpha \sqrt{g} \left( R + K^{ab}K_{ab} - K^{2} - \frac{1}{2}C^{a}C_{a} + \frac{1}{2}C_{\perp}^{2}\right) \ .
\end{equation}
This allows us to define conjugate momenta of dynamical variables $g_{ab}$, $\alpha$, $\beta^{a}$, $H_{\perp}$ and $H^{a}$ as following
\begin{subequations}\label{momenta}
\begin{align}
P^{ab} & \equiv \frac{\partial \mathscr{L}}{\partial {\dot g}_{ab}} = \sqrt{g}\left(Kg^{ab} - K^{ab} - \frac{C_{\perp}}{2}g^{ab}\right)\\
\pi & \equiv \frac{\partial \mathscr{L}}{\partial {\dot \alpha}} = \frac{\sqrt{g}}{\alpha}C_{\perp}\\
\rho_{a} & \equiv \frac{\partial \mathscr{L}}{\partial {\dot \beta}^{a}} = \frac{\sqrt{g}}{\alpha}C_{a}\\
\Omega & \equiv \frac{\partial \mathscr{L}}{\partial {\dot H}_{\perp}} = 0\\
\Omega_{a} & \equiv \frac{\partial \mathscr{L}}{\partial {\dot H}^{a}} = 0 \ .
\end{align}
\end{subequations}

By definition of Hamiltonian density, we have
\begin{equation}
\mathscr{H} \equiv P^{ab}{\dot g}_{ab} + \pi{\dot \alpha} + \rho_{a}{\dot \beta}^{a} + \Omega {\dot H}_{\perp} + \Omega_{a}{\dot H}^{a} - \mathscr{L} \ . 
\end{equation}
To obtain the explicit expression of $\mathscr{H}$ in terms of $g_{ab}$, $\alpha$, $\beta^{a}$, $H_{\perp}$, $H^{a}$ and their conjugate momenta $P^{ab}$, $\pi$, $\rho_{a}$, $\Omega$, $\Omega_{a}$ we need to invert Eqs.~(\ref{momenta}) to eliminate ${\dot g}_{ab}$, ${\dot \alpha}$ and ${\dot \beta}^{a}$. The inversion can be written down as follows
\begin{subequations}
\begin{align}
D_{t}g_{ab} & = \frac{2\alpha P_{ab}}{\sqrt{g}} - \frac{\alpha P g_{ab}}{\sqrt{g}} - \frac{\alpha^{2}\pi g_{ab}}{2\sqrt{g}}\\
D_{t}\alpha & = \frac{\alpha^{3}\pi}{4\sqrt{g}} - \alpha^{2}H_{\perp} - \frac{\alpha^{2}P}{2\sqrt{g}}\\
D_{t}\beta^{a} & = \alpha^{2}H^{a} + \alpha^{2}\Delta \Gamma^{a}_{~bc}g^{bc} - \alpha g^{ab}\partial_{b}\alpha - \frac{\alpha^{3}}{\sqrt{g}}\rho^{a} \ .
\end{align}
\end{subequations}
It is worth noting that terms on the left hand side are covariant time derivative of $g_{ab}$, $\alpha$ and $\beta^{a}$, which are defined in Eq.~(\ref{spatialmetriccovarianttimederivative}, \ref{lapsecovarianttimederivative}, \ref{shiftcovarianttimederivative}), so that the equations are in a general covariant form. 

However, it is impossible to invert the last two equations in Eqs.~(\ref{momenta}), $\Omega = 0$ and $\Omega^{a} = 0$. They turn out to serve as primary constraints of the system and we need to write ${\dot H}_{\perp}$ and ${\dot H}_{a}$ as arbitrary multipliers of these constraints
\begin{subequations}
\begin{align}
{\dot H}_{\perp} & = \Lambda\\
{\dot H}^{a} & = \Lambda^{a} \ .
\end{align}
\end{subequations}
Write the resulting Hamiltonian density out explicitly, we have
\begin{align}
	\begin{split}
		\mathscr{H} &= \frac{\alpha}{\sqrt{g}}\left(P^{ab}P_{ab} - \frac{P^{2}}{2} - \frac{\alpha P \pi}{2} + \frac{\alpha^{2}\pi^{2}}{8} - \frac{\alpha^{2}}{2}\rho_{a}\rho^{a}\right)\\
		& -\alpha^{2}\pi H_{\perp} + \alpha^{2}\rho_{a}H^{a} + \alpha^{2}\Delta\Gamma^{a}_{~bc}g^{bc}\rho_{a} - \alpha \rho^{a}\partial_{a}\alpha - \alpha\sqrt{g}R\\
		& + P^{ab} \mathcal{L}_{\beta}g_{ab} + \pi \left[\beta^{c}\partial_{c}\alpha + \frac{\alpha}{{\bar \alpha}}\left({\dot {\bar \alpha}} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}\right)\right]\\
		& + \rho_{a}\left[{\dot {\bar \beta}}^{a} + \frac{\Delta \beta^{a}}{{\bar \alpha}}\left({\dot {\bar \alpha}} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}\right) + \beta^{b}{\bar D}_{b}\Delta \beta^{a} - \Delta \beta^{b} {\bar D}_{b}{\bar \beta}^{a}\right]\\
		& + \Omega \Lambda + \Omega_{a}\Lambda^{a}
	\end{split}
\end{align}
Consequently, we can write the action in Hamiltonian form as
\begin{equation}\label{non covariant action}
S[g, P, \alpha, \pi, \beta, \rho, H, \Omega, \Lambda ]\footnote{Indices of arguments are ommitted here for the purpose of a concise presentation. } = \int d^{4}x \left(P^{ab}{\dot g}_{ab} + \pi {\dot \alpha} + \rho_{a}{\dot \beta}^{a} + \Omega{\dot H_{\perp}} + \Omega_{a}{\dot H}^{a} - \mathscr{H}\right) \ .
\end{equation}
Hamilton's equations of motion can be derived from the action by applying the least action principle, i.e., $\delta S = 0$. Therefore, by varying the action with respect to the canonical variables, we have
\begin{subequations}\label{non covariant hamilton}
\begin{align}
{\dot g}_{ab} & = \frac{\partial \mathscr{H}}{\partial P^{ab}} = \mathcal{L}_{\beta}g_{ab} + \frac{2\alpha}{\sqrt{g}}P_{ab} - \frac{\alpha P}{\sqrt{g}}g_{ab} - \frac{\alpha^{2}\pi}{2\sqrt{g}}g_{ab}\\
\begin{split}
{\dot P}^{ab} & = -\frac{\partial \mathscr{H}}{\partial g_{ab}} = \mathcal{L}_{\beta}P^{ab} - \frac{2\alpha}{\sqrt{g}}P^{ac}P^{bd}g_{cd} + \frac{\alpha}{\sqrt{g}}PP^{ab} + \frac{\alpha^{2}\pi}{2\sqrt{g}
}P^{ab} - \frac{\alpha^{3}}{2\sqrt{g}}\rho^{a}\rho^{b}\\
& + \frac{\alpha}{2\sqrt{g}}P^{cd}P_{cd}g^{ab} - \frac{\alpha P^{2}}{4\sqrt{g}}g^{ab} - \frac{\alpha^{2}P\pi}{4\sqrt{g}}g^{ab} + \frac{\alpha^{2}\pi^{3}}{16\sqrt{g}}g^{ab} - \frac{\alpha^{3}}{4\sqrt{g}}\rho^{c}\rho_{c}g^{ab}\\
& + \alpha^{2}\rho_{e}\Delta \Gamma^{e}_{~cd}g^{ac}g^{bd} - \frac{1}{2}D_{c}\left(\rho^{c}\alpha^{2}\right)g^{ab} + D^{(a}\left(\rho^{b)}\alpha^{2}\right) - \frac{1}{2}\rho^{(a}D^{b)}\alpha^{2}\\
& - \alpha \sqrt{g}G^{ab} + \sqrt{g}D^{a}D^{b}\alpha - \sqrt{g}g^{ab}D_{c}D^{c}\alpha
\end{split}\\
{\dot \alpha} & = \frac{\partial \mathscr{H}}{\partial \pi} = \mathcal{L}_{\beta}\alpha  + \frac{\alpha}{{\bar \alpha}}\left({\dot {\bar \alpha}} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}\right) - \frac{\alpha^{2}}{2\sqrt{g}}P + \frac{\alpha^{3}\pi}{4\sqrt{g}} - \alpha^{2}H_{\perp}\\
\begin{split}
{\dot \pi} & = - \frac{\partial \mathscr{H}}{\partial \alpha} = \mathcal{L}_{\beta}\pi - \frac{\pi}{{\bar \alpha}}\left({\dot {\bar \alpha}} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}\right) + 2\alpha\pi H_{\perp} - 2\alpha \rho_{a}H^{a} - 2\alpha\Delta \Gamma^{a}_{~bc}g^{bc}\rho_{a}\\
&- \frac{1}{\sqrt{g}}P^{ab}P_{ab} + \frac{P^{2}}{2\sqrt{g}} + \frac{\alpha P \pi}{\sqrt{g}} - \frac{3\alpha^{2}\pi^{2}}{8\sqrt{g}} + \frac{3\alpha^{2}}{2\sqrt{g}}\rho_{a}\rho^{a} - \alpha \partial_{a}\rho^{a} + \sqrt{g}R
\end{split}\\
\begin{split}
{\dot \beta}^{a} & = \frac{\partial \mathscr{H}}{\partial \rho_{a}} = {\dot {\bar \beta}}^{a} + \left(\beta^{b}{\bar D}_{b}\Delta \beta^{a} - \Delta \beta^{b} {\bar D}_{b}{\bar \beta}^{a}\right) + \frac{\Delta \beta^{a}}{{\bar \alpha}}\left({\dot {\bar \alpha}} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}\right) - \frac{\alpha^{3}}{\sqrt{g}}\rho^{a} + \alpha^{2}H^{a}\\
& + \alpha^{2}\Delta \Gamma^{a}_{~bc}g^{bc} - \alpha g^{ab}\partial_{b}\alpha
\end{split}\\
\begin{split}
{\dot \rho}_{a} & = -\frac{\partial \mathscr{H}}{\partial \beta^{a}} = - \rho_{b}{\bar D}_{a}\Delta\beta^{b} + \partial_{b}\left(\rho_{a}\beta^{b}\right) - \rho_{c}\beta^{b}{\bar \Gamma}^{c}_{~ab} + \rho_{b}{\bar D}_{a}{\bar \beta}^{b} - \frac{\rho_{a}}{{\bar \alpha}}\left({\dot {\bar \alpha}} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}\right)\\
& - P^{bc}\partial_{a}g_{bc} + 2\partial_{b}\left(P^{bc}g_{ac}\right) - \pi \partial_{a}\alpha
\end{split}\\
{\dot H}_{\perp} & = \frac{\partial \mathscr{H}}{\partial \Omega } = \Lambda\\
{\dot \Omega} & = - \frac{\partial \mathscr{H}}{\partial H_{\perp}} = \alpha^{2}\pi\\
{\dot H}^{a} & = \frac{\partial \mathscr{H}}{\partial \Omega_{a}} = \Lambda^{a}\\
{\dot \Omega}_{a} & = - \frac{\partial \mathscr{H}}{\partial H^{a}} = -\alpha^{2}\rho_{a} \ .
\end{align}
\end{subequations}

One may notice that Eqs.~(\ref{non covariant hamilton}) are not manifestly covariant under foliation preserving transformation. This is a direct result from the fact that the action itself(\ref{non covariant action}) is not manifestly covariant. It is the presence of non-covariant time derivatives, such as $P^{ab}{\dot g}_{ab}$, $\pi{\dot \alpha}$, $\rho_{a}{\dot \beta}$, $\Omega{\dot H}_{\perp}$ and $\Omega_{a}{\dot H}^{a}$, that prevents the action from being manifestly covariant. However, a more careful observation reveals that, non-coincidentally, we can extract some terms from the hamiltonian $\mathscr{H}$ to combine with the ordinary time derivative terms and make them covariant time derivatives $D_{t}g_{ab}$, $D_{t}\alpha$, $D_{t}\beta^{a}$, as presented in Eqs.~(\ref{spatialmetriccovarianttimederivative}, \ref{lapsecovarianttimederivative}, \ref{shiftcovarianttimederivative}). Therefore, we start to modify the action presentation as following
\begin{equation}\label{modified action}
S[g, P, \alpha, \pi, \beta, \rho, H, \Omega, \Lambda ] = \int d^{4}x \left( P^{ab}D_{t}g_{ab} + \pi D_{t}\alpha + \rho_{a}D_{t}\beta^{a} + \Omega {\dot H}_{\perp} + \Omega_{a}{\dot H}^{a} - \tilde{\mathscr{H}}\right)
\end{equation}
where
\begin{align}
\begin{split}
\tilde{\mathscr{H}} & = \frac{\alpha}{\sqrt{g}}\left(P^{ab}P_{ab} - \frac{P^{2}}{2} - \frac{\alpha P \pi}{2} + \frac{\alpha^{2}\pi^{2}}{8} - \frac{\alpha^{2}}{2}\rho_{a}\rho^{a}\right)\\
& -\alpha^{2}\pi H_{\perp} + \alpha^{2}\rho_{a}H^{a} + \alpha^{2}\Delta\Gamma^{a}_{~bc}g^{bc}\rho_{a} - \alpha \rho^{a}\partial_{a}\alpha - \alpha\sqrt{g}R\\
& + \Omega \Lambda + \Omega_{a}\Lambda^{a}
\end{split}
\end{align}
is the modified Hamiltonian density. 

Note that in the modified action (\ref{modified action}), we still have two non-covariant terms $\Omega {\dot H}_{\perp}$ and $\Omega_{a}{\dot H}^{a}$ for which we are not able to find any complement terms in $\mathscr{H}$ to combine with. This problem can be solved by extending the Hamiltonian, which is discussed in detail in the following section. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Hamiltonian Extension}\label{extension}
Due to the Hamiltonian's constraints $\Omega = 0$ and $\Omega_{a} = 0$, we notice that the histories extremize the action, which contains $\Omega \Lambda$ and $\Omega_{a}\Lambda^{a}$, are invariant if we replace the multipliers by $\Lambda \rightarrow \Lambda + {\hat \Lambda}$ and $\Lambda^{a} \rightarrow \Lambda^{a} + {\hat \Lambda}^{a}$ while restraining ${\hat \Lambda}$ and ${\hat \Lambda}^{a}$ to be quasilinear functions of the canonical variables. What quasilinear means is that the principal parts of ${\hat \Lambda}$ and ${\hat \Lambda}^{a}$ are linear in the momenta $P^{ab}$, $\pi$, $\rho_{a}$, $\Omega$ and $\Omega_{a}$; and first spatial derivatives of the coordinates $\partial_{c}g_{ab}$, $\partial_{a}\alpha$, $\partial_{b}\beta^{a}$, $\partial_{a}H_{\perp}$ and $\partial_{b}H^{a}$ with coefficients depending on the coordinates. With these replacements, the modified Hamiltonian density becomes
\begin{align}
\begin{split}
\tilde{\mathscr{H}} & = \frac{\alpha}{\sqrt{g}}\left(P^{ab}P_{ab} - \frac{P^{2}}{2} - \frac{\alpha P \pi}{2} + \frac{\alpha^{2}\pi^{2}}{8} - \frac{\alpha^{2}}{2}\rho_{a}\rho^{a}\right)\\
& -\alpha^{2}\pi H_{\perp} + \alpha^{2}\rho_{a}H^{a} + \alpha^{2}\Delta\Gamma^{a}_{~bc}g^{bc}\rho_{a} - \alpha \rho^{a}\partial_{a}\alpha - \alpha\sqrt{g}R\\
& + \Omega {\hat \Lambda} + \Omega_{a}{\hat \Lambda}^{a} \ .
\end{split}
\end{align}
Note that here we absorb $\Lambda$ and $\Lambda^{a}$ into functions ${\hat \Lambda}$ and ${\hat \Lambda}^{a}$, respectively. Now we can choose ${\hat \Lambda}$ and ${\hat \Lambda}^{a}$ appropriately so that they can combine with ${\dot H}_{\perp}$ and ${\dot H}^{a}$ to form $D_{t}H_{\perp}$ and $D_{t}H^{a}$ respectively, i.e., 
\begin{subequations}
\begin{align}
{\hat \Lambda} & = \mathcal{L}_{\beta}H_{\perp}\\
{\hat \Lambda}^{a} & = \mathcal{L}_{\beta}H^{a} \ .
\end{align}
\end{subequations}
From here we obtain a generally covariant format of the action as
\begin{equation}\label{covariant action}
\begin{split}
S[g, P, \alpha, \pi, \beta, \rho, H, \Omega, \Lambda ] = & \int d^{4}x ~~~~P^{ab}D_{t}g_{ab} + \pi D_{t}\alpha + \rho_{a}D_{t}\Delta \beta^{a} + \Omega D_{t}H_{\perp} + \Omega_{a}D_{t}H^{a}\\
& - \frac{\alpha}{\sqrt{g}}\left(P^{ab}P_{ab} - \frac{P^{2}}{2} - \frac{\alpha P \pi}{2} + \frac{\alpha^{2}\pi^{2}}{8} - \frac{\alpha^{2}}{2}\rho_{a}\rho^{a}\right)\\
& +\alpha^{2}\pi H_{\perp} - \alpha^{2}\rho_{a}H^{a} - \alpha^{2}\Delta\Gamma^{a}_{~bc}g^{bc}\rho_{a} + \alpha \rho^{a}\partial_{a}\alpha + \alpha\sqrt{g}R \ .
\end{split}
\end{equation}
Note that this action is both implicitly and explicitly covariant, i.e., it is covariant as a whole object and each individual term in the action is covariant by itself as well. 

A careful reader would also notice that, besides making the action manifestly covariant, there is one extra change from Eq.~(\ref{modified action}) to Eq.~(\ref{covariant action}) as well. The term coupling with $\rho_{a}$ is $D_{t}\Delta \beta$ instead of $D_{t}\beta^{a}$ now. A superficial justification for this operation is that from Eq.~(\ref{shiftcovarianttimederivative}) we can tell that $D_{t}{\bar \beta}^{a} = 0$ and hence $D_{t}\Delta \beta^{a} = D_{t}\beta^{a}$. Prior to a deeper understanding of this operation, let's first take a look at our approach to vary the action to get a set of manifestly covariant Hamilton's equations. 

By manifestly covariant, what we want is that terms on the left hand side and right hand side of equations of motion are both covariant. Therefore, instead of a ordinary time derivative operator on the left hand side of the equations, we require a covariant time derivative operator. Hence, when varying the action, we want the terms with covariant time derivative have the same product rule as ordinary time derivatives, i.e., for any generic coordinate variable $q$ and its conjugate momentum $p$, we require that
\begin{equation}\label{productrule}
D_{t}( pq ) = pD_{t}q + qD_{t}p \ .
\end{equation}
We also require $D_{t}(pq)$ has a format of total derivative so that it can be treated as boundary terms while varying the action. This works as long as $pq$ is a weight 1 density under spatial diffeomorphism and a scalar density under time reparameterization, in which case we have
\begin{equation}
D_{t}(pq) = \partial_{t}(pq) - \mathcal{L}_{\beta}(pq) = \partial_{t}(pq) - \partial_{c}\left(\beta^{c}pq\right) \ .
\end{equation}
Here resides the reason why we want to replace $\rho_{a}D_{t}\beta^{a}$ with $\rho_{a}D_{t}\Delta \beta^{a}$, since $\rho_{a}\Delta \beta^{a}$ is a weight 1 density under spatial diffeomorphism and a scalar under time reparameterization while $\rho_{a}\beta^{a}$ is not. 

With explicit definition of $D_{t}q$, the product rule allows us to define $D_{t}p$ from Eq.~(\ref{productrule}) in the following way
\begin{subequations}
\begin{align}
D_{t}P^{ab} & \equiv {\dot P}^{ab} - \mathcal{L}_{\beta}P^{ab}\\
D_{t}\pi & \equiv {\dot \pi} - \mathcal{L}_{\beta}\pi + \frac{\pi}{{\bar \alpha}}\left({\dot {\bar \alpha}} - {\bar \beta}^{a}\partial_{a}{\bar \alpha}\right)\\
D_{t}\rho_{a} & \equiv {\dot \rho}_{a} - \partial_{b}\left(\beta^{b}\rho_{a}\right) + \frac{\rho_{a}}{{\bar \alpha}}\left({\dot {\bar \alpha}} - {\bar \beta}^{b}\partial_{b}{\bar \alpha}\right) + \rho_{c}\beta^{b}{\bar \Gamma}^{c}_{ab} - \rho_{b}{\bar D}_{a}{\bar \beta}^{b}\\
D_{t}\Omega & \equiv {\dot \Omega} - \mathcal{L}_{\beta}\Omega\\
D_{t}\Omega_{a} & \equiv {\dot \Omega}_{a} - \mathcal{L}_{\beta}\Omega_{a} \ .
\end{align}
\end{subequations}

With these two properties of covariant time derivative, we can vary the covariant action to obtain the explicitly covariant Hamilton's equations as below,
\begin{subequations}\label{covarianthamilton}
\begin{align}
D_{t}g_{ab} & = \frac{2\alpha}{\sqrt{g}}P_{ab} - \frac{\alpha P}{\sqrt{g}}g_{ab} - \frac{\alpha^{2}\pi}{2\sqrt{g}}g_{ab}\\
\begin{split}
D_{t} P^{ab} & = - \frac{2\alpha}{\sqrt{g}}P^{ac}P^{bd}g_{cd} + \frac{\alpha}{\sqrt{g}}PP^{ab} + \frac{\alpha^{2}\pi}{2\sqrt{g}
}P^{ab} - \frac{\alpha^{3}}{2\sqrt{g}}\rho^{a}\rho^{b}\\
& + \frac{\alpha}{2\sqrt{g}}P^{cd}P_{cd}g^{ab} - \frac{\alpha P^{2}}{4\sqrt{g}}g^{ab} - \frac{\alpha^{2}P\pi}{4\sqrt{g}}g^{ab} + \frac{\alpha^{2}\pi^{3}}{16\sqrt{g}}g^{ab} - \frac{\alpha^{3}}{4\sqrt{g}}\rho^{c}\rho_{c}g^{ab}\\
& + \alpha^{2}\rho_{e}\Delta \Gamma^{e}_{~cd}g^{ac}g^{bd} - \frac{1}{2}D_{c}\left(\rho^{c}\alpha^{2}\right)g^{ab} + D^{(a}\left(\rho^{b)}\alpha^{2}\right) - \frac{1}{2}\rho^{(a}D^{b)}\alpha^{2}\\
& - \alpha \sqrt{g}G^{ab} + \sqrt{g}D^{a}D^{b}\alpha - \sqrt{g}g^{ab}D_{c}D^{c}\alpha
\end{split}\\
D_{t}\alpha & = - \frac{\alpha^{2}}{2\sqrt{g}}P + \frac{\alpha^{3}\pi}{4\sqrt{g}} - \alpha^{2}H_{\perp}\\
\begin{split}
D_{t}\pi & = 2\alpha\pi H_{\perp} - 2\alpha \rho_{a}H^{a} - 2\alpha\Delta \Gamma^{a}_{~bc}g^{bc}\rho_{a} - \frac{1}{\sqrt{g}}P^{ab}P_{ab} + \frac{P^{2}}{2\sqrt{g}} + \frac{\alpha P \pi}{\sqrt{g}}\\
& - \frac{3\alpha^{2}\pi^{2}}{8\sqrt{g}} + \frac{3\alpha^{2}}{2\sqrt{g}}\rho_{a}\rho^{a} - \alpha \partial_{a}\rho^{a} + \sqrt{g}R
\end{split}\\
D_{t}\Delta \beta^{a} & = - \frac{\alpha^{3}}{\sqrt{g}}\rho^{a} + \alpha^{2}H^{a} + \alpha^{2}\Delta \Gamma^{a}_{~bc}g^{bc} - \alpha g^{ab}\partial_{b}\alpha\\
D_{t}\rho_{a} & = - \rho_{b}{\bar D}_{a}\Delta\beta^{b} - P^{bc}\partial_{a}g_{bc} + 2\partial_{b}\left(P^{bc}g_{ac}\right) - \pi \partial_{a}\alpha - \Omega \partial_{a}H_{\perp} - \Omega_{b}\partial_{a}H^{b} - \partial_{b}\left(H^{b} \Omega_{a}\right)\\
D_{t}H_{\perp} & = 0\\
D_{t}\Omega & = \alpha^{2}\pi \label{omega}\\
D_{t}H^{a} & = 0\\
D_{t}\Omega_{a} & = -\alpha^{2}\rho_{a} \label{omega_a} \ .
\end{align}
\end{subequations}
In order for the Hamiltonian formulation discussed above to be practical in numerical application, we first need to prove that Eqs.~(\ref{covarianthamilton}) is well-posed. The definition of well-posedness for quasilinear partial differential equation system is discussed in Sec.~\ref{wellposednessdefinition} in detail. A complete well-posedness analysis of Eqs.~(\ref{covarianthamilton}) is presented in Sec.~\ref{wellposednessanalysis}.
%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%
\section{Well-posedness}\label{wellposedness}
\subsection{Definition}\label{wellposednessdefinition}
The notion of ``well-posed'' is originated from Jacques Hadamard, a French mathematician. He argues that mathematical models of physical phenomena should have the properties that a unique solution exists and the solution's behavior changes continuously with the initial conditions. Wald gave his own yet similar definition of well-posedness in his book {\em General Relativity}\cite{Wald:GRbook}. Wald's definition states that in order for a numerical formulation to be well-posed, firstly small changes in initial data should produce only correspondingly small changes in the solution over any fixed compact region of spacetime; and secondly changes of initial data in a region should only be responsible for changes in the solution inside the causal future of this region. The first requirement is necessary since it is impossible to measure initial condition in infinite accuracy. The second property guarantees no signal could propagate faster than the speed of light and keep the numerical formulation under framework of relativity theory. 

An algebraic criterion is introduced and widely adopted to analyze well-posedness of a quasilinear partial differential equation system, namely {\em hyperbolicity}. An initial value problem with weakly hyperbolicity is regarded as ill-posed. Strongly hyperbolicity is necessary and sufficient for an initial value problem without boundaries in space to be well-posed. For initial value systems with space boundaries being well-posed, an even stronger notion of hyperbolicity, symmetric hyperbolicity, is required. Gundlach, Mart\' \i n-Garc\' \i a\cite{Gundlach:2005ta} and Brown\cite{Brown:2008cca} have presented practical definition of various types of hyperbolicity and prescriptions to prove them. Their theories to determine the hyperbolicity of a Hamiltonian system is briefly reviewed as following. 

Well-posedness guarantees small perturbation in initial data only leads to proportional deviations of the solution. Therefore in analyzing well-posedness we are primarily concerned with evolutions of high wave number modes in initial value perturbations. For large wave numbers, behavior of the Hamiltonian system depends on the coefficients of the highest weight terms in the Hamiltonian, namely the principal terms. The principal symbol $A$ is a square matrix obtained by identifying the principal terms in Hamilton's equations. According to Brown's prescription\cite{Brown:2008cca}, for a Hamiltonian system with generalized coordinates $q_{\mu}$ and momenta $p_{\mu}$ \footnote{Here the subscript $\mu$ is merely a counting index rather than tensor notation.}, the principal parts of ${\dot q}_{\mu}$ equations are the terms proportional to $p_{\mu}$ and $\partial_{a}q_{\mu}$; principal parts of ${\dot p}_{\mu}$ equations are the terms proportional to $\partial_{a}p_{\mu}$ and $\partial_{a}\partial_{b}q_{\mu}$. To construct the principal symbol $A$, one only needs to carry out the following substitution
\begin{subequations}\label{substitution}
\begin{align}
p_{\mu} & \rightarrow {\bar p}_{\mu}\\
\partial_{a}q_{\mu} &\rightarrow n_{a}{\bar q}_{\mu}\\
\partial_{a}p_{\mu} & \rightarrow n_{a}{\bar p}_{\mu}\\
\partial_{a}\partial_{b}p_{\mu} & \rightarrow n_{a}n_{b}{\bar p}_{\mu} \ ,
\end{align}
\end{subequations}
where ${\bar q}_{\mu}$ and ${\bar p}_{\mu}$ are Fourier mode amplitudes of corresponding perturbations for $q_{\mu}$ and $p_{\mu}$. The principal symbol $A$ is formed from the coefficients of ${\bar q}_{\mu}$ and ${\bar p}_{\mu}$. 

Solving eigen problem of the principal symbol $A$ reveals hyperbolicity of the PDE system in consideration. If all eigenvalues of $A$ are real but the eigenvectors are not complete, the system is regarded as weakly hyperbolic. By contrast, a system whose principal symbol $A$ has all real eigenvalues and a complete set of eigenvectors is said to be strongly hyperbolic. 

To further prove symmetric hyperbolicity, an energy term $\epsilon$ in quadratic form of the dynamic variables $p_{\mu}$, $q_{\mu}$ needs to be determined. Gundlach and Mart\' \i n-Garc\' \i a\cite{Gundlach:2005ta} pointed out that if $\epsilon$ is positive definite\footnote{$\epsilon = 0$ if and only if $q_{\mu} = 0$ and $p_{\mu} = 0$.} and the principal part of its time derivative can be written as the gradient of a vector $\phi^{a}$, i.e., $\partial_{t}\epsilon \cong \partial_{a}\phi^{a}$, the Hamiltonian system is considered to be symmetric hyperbolic. 

\subsection{Analysis}\label{wellposednessanalysis}
Following the recipe given above, we first extract the principal part of Eqs.~(\ref{covarianthamilton}) as
\begin{subequations}\label{principalhamilton}
\begin{align}
\partial_{\perp}g_{ab} &\cong 2g_{c(a}\partial_{b)}\beta^{c} + \frac{2\alpha}{\sqrt{g}}P_{ab} - \frac{\alpha P}{\sqrt{g}}g_{ab} - \frac{\alpha^{2}\pi}{2\sqrt{g}}g_{ab}\\
\begin{split}
\partial_{\perp}P^{ab} &\cong \frac{\alpha\sqrt{g}}{2}g^{ac}g^{bd}g^{ef}\left(\partial_{c}\partial_{d}g_{ef} + \partial_{e}\partial_{f}g_{cd} - 2\partial_{e}\partial_{(c}g_{d)f}\right)\\
& + \frac{\alpha\sqrt{g}}{2}g^{ab}g^{cd}g^{ef}\left(\partial_{c}\partial_{e}g_{df} - \partial_{c}\partial_{d}g_{ef}\right)\\
& + \sqrt{g}\left(g^{ac}g^{bd} - g^{ab}g^{cd}\right)\partial_{c}\partial_{d}\alpha\\
& + \alpha^{2}\left(g^{c(a}g^{b)d} - \frac{1}{2}g^{ab}g^{cd}\right)\partial_{c}\rho_{d}
\end{split}\\
\partial_{\perp}\alpha & \cong -\frac{\alpha^{2}}{2\sqrt{g}}P + \frac{\alpha^{3}}{4\sqrt{g}}\pi\\
\partial_{\perp}\pi & \cong -\alpha g^{ab}\partial_{a}\rho_{b} + \sqrt{g}\left(g^{ac}g^{bd} - g^{ab}g^{cd}\right)\partial_{a}\partial_{b}g_{cd}\\
\partial_{\perp}\beta^{a} & \cong -\alpha g^{ab}\partial_{b}\alpha - \frac{\alpha^{3}}{\sqrt{g}}g^{ab}\rho_{b} + \alpha^{2}\left(g^{ac}g^{bd} - \frac{1}{2}g^{ab}g^{cd}\right)\partial_{b}g_{cd}\\
\partial_{\perp}\rho_{a} & \cong 2g_{ab}\partial_{c}P^{bc} - H^{b}\partial_{b}\Omega_{a}\\
\partial_{\perp}H_{\perp} & \cong 0\\
\partial_{\perp}\Omega & \cong 0\\
\partial_{\perp}H^{a} & \cong 0\\
\partial_{\perp}\Omega_{a} & \cong 0 \ .
\end{align}
\end{subequations}
The $\cong$ symbol denotes equality up to non principal terms. These equations are expressed in terms of the operator $\partial_{\perp} \equiv \partial_{t} - \beta^{a}\partial_{a}$ so that the characteristic speeds are defined with respect to observers who are at rest in the spacelike slices. 

The next step is to construct the principal symbol $A$ by making the replacement described in Eqs.~(\ref{substitution}) and identifying coefficients on the right-hand sides of Eqs.~(\ref{principalhamilton}). We also divide these coefficients by a factor of $\alpha$ so that the characteristic speeds can be expressed in terms of proper time rather than coordinate time. The resulting eigenvalue problem is
\begin{subequations}\label{eigensystem}
\begin{align}
\mu {\bar g}_{ab} & = \frac{2}{\alpha}n_{(a}{\bar \beta}_{b)} + \frac{2}{\sqrt{g}}{\bar P}_{ab} - \frac{g_{ab}}{\sqrt{g}}\left({\bar P}_{nn} + {\bar P}_{AB}\delta^{AB}\right) - \frac{\alpha g_{ab}}{2\sqrt{g}}{\bar \pi}\\
\begin{split}
\mu {\bar P}_{ab} & = \frac{\sqrt{g}}{2}n_{a}n_{b}\left({\bar g}_{nn} + {\bar g}_{AB}\delta^{AB}\right) + \frac{\sqrt{g}}{2}{\bar g}_{ab} - \sqrt{g} n_{(a}{\bar g}_{b)n} - \frac{\sqrt{g}}{2}g_{ab}{\bar g}_{AB}\delta^{AB}\\
& + \frac{\sqrt{g}}{\alpha}n_{a}n_{b}{\bar \alpha} - \frac{\sqrt{g}}{\alpha}g_{ab}{\bar \alpha} + \alpha n_{(a}{\bar \rho}_{b)} - \frac{1}{2}\alpha g_{ab}{\bar \rho}_{n}
\end{split}\\
\mu {\bar \alpha} & = -\frac{\alpha}{2\sqrt{g}}\left({\bar P}_{nn} + {\bar P}_{AB}\delta^{AB}\right) + \frac{\alpha^{2}}{4\sqrt{g}}{\bar \pi}\\
\mu {\bar \beta}_{a} & = -n_{a}{\bar \alpha} - \frac{\alpha^{2}}{\sqrt{g}}{\bar \rho}_{a} + {\bar \alpha}{\bar g}_{nn} - \frac{1}{2}\alpha n_{a}\left({\bar g}_{nn} + {\bar g}_{AB}\delta^{AB}\right)\\
\mu {\bar \rho}_{a} & = \frac{2}{\alpha}{\bar P}_{an} - \frac{\left(H \cdot n \right)}{\alpha}{\bar \Omega}_{a}\\
\mu {\bar H}_{\perp} & = 0\\
\mu {\bar \Omega} & = 0\\
\mu {\bar H}_{a} & = 0\\
\mu {\bar \Omega}_{a} & = 0 \ .
\end{align}
\end{subequations}
Eqs.~(\ref{eigensystem}) can be interpreted as an eigensystem $\mu v = A v$ with eigenvalue $\mu$, where the eigenvector $v = [{\bar g}_{ab}, {\bar P}_{ab}, {\bar \alpha}, {\bar \pi}, {\bar \beta}_{a}, {\bar \rho}_{a}, {\bar H}_{\perp}, {\bar \Omega}, {\bar H}_{a}, {\bar \Omega}_{a}]^{T}$ and $A$ is the principal symbol we need. 

In Eqs.~(\ref{eigensystem}), a subscript $n$ denotes contraction with $n^{a}$. We introduce an orthonormal diad $e^{a}_{A}$ with $A = 1, 2$ in the subspace orthogonal to $n_{a}$, which means $n_{a}e^{a}_{A} = 0$ and $e^{a}_{A}g^{ab}e^{b}_{B} = \delta^{AB}$. A subscript A denotes contraction with $e^{a}_{A}$.

We can further split the eigensystem (\ref{eigensystem}) into scalar, vector and trace-free tensor blocks by contracting the equations with $n^{a}$ and/or $e^{a}_{A}$. Since these sectors can be interpreted as diagonal blocks of the principal symbol $A$, each block can be studied individually to gain some insight of the system's hyperbolicity. 

First of all, the scalar block is
\begin{subequations}
\begin{align}
\mu {\bar g}_{nn} & = \frac{2}{\alpha}{\bar \beta}_{n} + \frac{1}{\sqrt{g}}{\bar P}_{nn} - \frac{1}{\sqrt{g}}{\bar P}_{AB}\delta^{AB} - \frac{\alpha}{2\sqrt{g}}{\bar \pi}\\
\mu {\bar g}_{AB}\delta^{AB} & = - \frac{2}{\sqrt{g}}{\bar P}_{nn} - \frac{\alpha}{\sqrt{g}}{\bar \pi}\\
\mu {\bar P}_{nn} & = \frac{1}{2}\alpha{\bar \rho}_{n}\\
\mu {\bar P}_{AB}\delta^{AB} & = -\frac{\sqrt{g}}{2}{\bar g}_{AB}\delta^{AB} - \frac{2}{\alpha}\sqrt{g} {\bar \alpha} - \alpha {\bar \rho}_{n}\\
\mu {\bar \alpha} & = - \frac{\alpha}{2\sqrt{g}}\left({\bar P}_{nn} + {\bar P}_{AB}\delta^{AB}\right) + \frac{\alpha^{2}}{4\sqrt{g}}{\bar \pi}\\
\mu {\bar \pi} & = -\frac{\sqrt{g}}{\alpha}{\bar g}_{AB}\delta^{AB} - {\bar \rho}_{n}\\
\mu {\bar \beta}_{n} & = - {\bar \alpha} - \frac{\alpha^{2}}{\sqrt{g}}{\bar \rho}_{n} + \frac{\alpha}{2}{\bar g}_{nn} - \frac{\alpha}{2}{\bar g}_{AB}\delta^{AB}\\
\mu {\bar \rho}_{n} & = \frac{2}{\alpha}{\bar P}_{nn} -  \frac{\left(H \cdot n \right)}{\alpha}{\bar \Omega}_{n}\\
\mu {\bar H}_{\perp} & = 0\\
\mu {\bar \Omega} & = 0\\
\mu {\bar H}_{n} & = 0\\
\mu {\bar \Omega}_{n} & = 0 \ .
\end{align}
\end{subequations}
The vector sector is
\begin{subequations}
\begin{align}
\mu {\bar g}_{nA} & = \frac{2}{\sqrt{g}}{\bar P}_{nA} + \frac{1}{\alpha}{\bar \beta}_{A}\\
\mu {\bar P}_{nA} & = \frac{\alpha}{2}{\bar \rho}_{A}\\
\mu {\bar \beta}_{A} & = \alpha {\bar g}_{nA} - \frac{\alpha^{2}}{\sqrt{g}}{\bar \rho}_{A}\\
\mu {\bar \rho}_{A} & = \frac{2}{\alpha}{\bar P}_{nA} - \frac{\left(H \cdot n \right)}{\alpha}{\bar \Omega}_{A}\\
\mu {\bar H}_{A} & = 0\\
\mu {\bar \Omega}_{A} & = 0 \ .
\end{align}
\end{subequations}
At last, the trace-free tensor sector is
\begin{subequations}
\begin{align}
\mu {\bar g}^{tf}_{AB} & = \frac{2}{\sqrt{g}}{\bar P}^{tf}_{AB}\\
\mu {\bar P}^{tf}_{AB} & = \frac{\sqrt{g}}{2}{\bar g}^{tf}_{AB} \ .
\end{align}
\end{subequations}
Solving the three sub-eigenproblems reveals that eigenvalues for the scalar sector are $\pm 1$ and 0, each with multiplicity four; eigenvalues for the vector sector are $\pm 1$ with multiplicity two and 0 with multiplicity two as well; eigenvalues for the trace-free tensor sector are $\pm 1$; eigenvectors for all the three sectors are complete, which draws the conclusion that the system is strongly hyperbolic. 

To further prove this system is symmetric hyperbolic, we apply Gundlach and Matrtin-Garcia\cite{Gundlach:2005ta}'s definition of symmetric hyperbolicity for quasilinear systems of partial differential equations with first-order time and second-order space derivatives and follow the analysis described in Ref.~\cite{Brown:2011qg}. To begin with, we introduce the spatial derivates of the 3 + 1 coordinate variables $g_{ab}, \alpha, \beta^{a}, H_{\perp}$ and $H^{a}$ as a new set of variables
\begin{subequations}
\begin{align}
g_{cab} & \equiv \partial_{c}g_{ab}\\
\alpha_{a} & \equiv \partial_{a}\alpha\\
\beta_{ab} & \equiv g_{ac}\partial_{b}\beta^{c}\\
H_{\perp a} & \equiv \partial_{a}H_{\perp}\\
H_{ab} & \equiv g_{ac}\partial_{b}H^{c} \ .
\end{align}
\end{subequations}
Then we compute the equations of motion for this new set of variables by differentiating Eqs.~(\ref{covarianthamilton}). Combine the resulting equations of motion with Hamilton's equations for the momenta, we obtain a new system as following(up to the principal terms)
\begin{subequations}\label{symmetric hamilton}
\begin{align}
\partial_{\perp}g_{cab} & \cong 2\partial_{c}\beta_{(ab)} + \frac{2\alpha}{\sqrt{g}}\partial_{c}P_{ab} - \frac{\alpha}{\sqrt{g}}g_{ab}g^{de}\partial_{c}P_{de} - \frac{\alpha^{2}}{2\sqrt{g}}g_{ab}\partial_{c}\pi\\
\begin{split}
\partial_{\perp}P_{ab} & \cong \frac{\alpha\sqrt{g}}{2}g^{cd}\left(\partial_{a}g_{bcd} + \partial_{c}g_{dab} - 2\partial_{c}g_{(ab)d}\right)\\
& + \frac{\alpha \sqrt{g}}{2}g_{ab}g^{cd}g^{ef}\left(\partial_{c}g_{edf} - \partial_{c}g_{def}\right)\\
& + \sqrt{g}\left(\partial_{a}\alpha_{b} - g_{ab}g^{cd}\partial_{c}\alpha_{d}\right) + \alpha^{2}\left(\partial_{(a}\rho_{b)} - \frac{1}{2}g_{ab}g^{cd}\partial_{c}\rho_{d}\right)
\end{split}\\
\partial_{\perp}\alpha_{a} & \cong -\frac{\alpha^{2}}{2\sqrt{g}}g^{cd}\partial_{a}P_{cd} + \frac{\alpha^{3}}{4\sqrt{g}}\partial_{a}\pi\\
\partial_{\perp}\pi & \cong - \alpha g^{ab}\partial_{a}\rho_{b} + \sqrt{g}\left(g^{ac}g^{bd} - g^{ab}g^{cd}\right)\partial_{a}g_{bcd}\\
\partial_{\perp}\beta_{ab} & \cong -\alpha \partial_{a}\alpha_{b} - \frac{\alpha^{3}}{\sqrt{g}}\partial_{a}\rho_{b} + \alpha^{2}\left(g^{cd}\partial_{a}g_{cbd} - \frac{1}{2}g^{cd}\partial_{a}g_{bcd}\right)\\
\partial_{\perp}\rho_{a} & \cong 2g^{bc}\partial_{c}P_{ab} - H^{b}\partial_{b}\Omega_{a}\\
\partial_{\perp}H_{\perp a} & \cong 0\\
\partial_{\perp}\Omega & \cong 0\\
\partial_{\perp}H_{ab} & \cong 0\\
\partial_{\perp}\Omega_{a} & \cong 0.
\end{align}
\end{subequations}
The quadratic energy term is defined as follows
\tiny
\begin{align}
\begin{split}
\epsilon = & M^{abef}\left[g^{cd}\left(\frac{g_{cab}}{2} - \frac{\alpha_{c}}{\alpha}g_{ab}\right)\left(\frac{g_{def}}{2} - \frac{\alpha_{d}}{\alpha}g_{ef}\right) + \left(\frac{P_{ab}}{\sqrt{g}} + \frac{\beta_{(ab)}}{\alpha} - \frac{\alpha \pi g_{ab}}{2\sqrt{g}}\right)\left(\frac{P_{ef}}{\sqrt{g}} + \frac{\beta_{(ef)}}{\alpha} - \frac{\alpha \pi g_{ef}}{2\sqrt{g}}\right) + H_{ab}H_{ef}\right]\\
& + M^{ab}\left[\frac{g^{cd}}{\alpha^{2}}\left(\beta_{(ac)} + \frac{\alpha}{\sqrt{g}}H_{(a}\Omega_{c)}\right)\left(\beta_{(bd)} + \frac{\alpha}{\sqrt{g}}H_{(b}\Omega_{d)}\right) + \left(\frac{\alpha \rho_{a}}{\sqrt{g}} - \Gamma_{acd}g^{cd} + \frac{\alpha_{a}}{\alpha}\right) \left(\frac{\alpha \rho_{b}}{\sqrt{g}} - \Gamma_{bcd}g^{cd} + \frac{\alpha_{b}}{\alpha}\right) + H_{\perp a}H_{\perp b} + \Omega_{a}\Omega_{b}\right]\\
& + M\left[g^{ab}g^{cd}\left(\beta_{ab} - \frac{2\alpha}{\sqrt{g}}P_{ab}\right)\left(\beta_{cd} - \frac{2\alpha}{\sqrt{g}}P_{cd}\right) + g^{cd}\left(\frac{\alpha g^{ab}}{2}g_{cab} + 3\alpha_{c}\right)\left(\frac{\alpha g^{ab}}{2}g_{dab} + 3\alpha_{d}\right) + \Omega^{2}\right]
\end{split}
\end{align}
\normalsize
where the tensors $M^{abef}$, $M^{ab}$ and $M$ are positive definite. Using Eqs.~(\ref{symmetric hamilton}) shows that the time derivative of $\epsilon$ has a principal part that can be written as the gradient of a vector $\phi^{a}$; that is, ${\dot \epsilon} \cong \partial_{a}\phi^{a}$. This leads to the conclusion that $\epsilon$ is a quadratic, positive-definite energy density with flux $\phi^{a}$ and hence the PDE system (\ref{covarianthamilton}) is symmetric hyperbolic. 

Since the generalized harmonic formulation is well known to be symmetric hyperbolic, we hereby conclude that the Hamiltonian approach to GH formulation developed in this paper conserves this merit and is practical to numerical applications. 


